/*
 * solar-system
 * @Description Solar System with Threejs
 * @version v0.0.22 - 2015-08-31
 * @link https://github.com/KenEDR/three-solar-system#readme
 * @author Enrique Daimiel Ruiz <k.daimiel@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
THREE.SolarCamera=function(a){THREE.PerspectiveCamera.call(this),this.type="SolarCamera",this.zoom=void 0!==a.zoom?a.zoom:1,this.fov=void 0!==a.fov?a.fov:50,this.aspect=void 0!==a.aspect?a.aspect:window.innerWidth/window.innerHeight,this.near=void 0!==a.near?a.near:.1,this.far=void 0!==a.far?a.far:2e3,this.position.x=void 0!==a.position.x?a.position.x:0,this.position.y=void 0!==a.position.y?a.position.y:0,this.position.z=void 0!==a.position.z?a.position.z:0,this.updateProjectionMatrix()},THREE.SolarCamera.prototype=Object.create(THREE.PerspectiveCamera.prototype),THREE.SolarCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.SolarObject=function(a){THREE.Object3D.call(this),this.satellites=[],this.name=a.name,this.type="SolarObject",this.category=a.category,this.radius=a.radius||50,this.vRotation=a.vRotation||0,this.vTranslation=a.vTranslation||0,this.tilt=a.tilt,this.distance=a.distance,this.URLTexture=a.URLTexture,this.geometry=new THREE.SphereGeometry(this.radius,50,50);var b=THREE.ImageUtils.loadTexture(this.URLTexture);this.material=new THREE.MeshBasicMaterial({map:b}),this.position.z=a.distance||0,this.rotation.x=this.tilt||0;for(var c in a.satellites)this.add(new THREE.SolarObject(a.satellites[c]));this.updateMorphTargets()},THREE.SolarObject.prototype=Object.create(THREE.Mesh.prototype),THREE.SolarObject.prototype.constructor=THREE.SolarObject,THREE.SolarObject.prototype.addSatellite=function(a){this.satellites.push(a)},THREE.SolarObject.prototype.createOrbit=function(a){this.parent=new THREE.Object3D,this.parent.position=a,this.parent.add(this),this.position.z=a.z+this.orbitDistance},THREE.SolarObject.prototype.update=function(){this.rotation.y+=this.vRotation*Math.PI/180;for(var a in this.satellites)this.satellites[a].updateOrbit(this.position)},THREE.SolarObject.prototype.updateOrbit=function(a){this.parent.position=a,this.parent.position.y=this.parent.rotation.y,this.parent.rotation.y+=this.vTranslation*Math.PI/180||0,"Earth"===this.orbit&&(console.log(a),console.log(this.parent.rotation.y),console.log(this.position.z+" - "+this.parent.position.z+" - "+a.z))},define("scene-factory",function(){"use strict";function a(a){g=new THREE.SolarCamera(a),i=new THREE.TrackballControls(g),i.addEventListener("change",c)}function b(a){var b=new THREE.SolarObject(a);if(j.push(b),a.orbit){for(var c in j)j[c].name===a.orbit&&(b.createOrbit(j[c].position),j[c].addSatellite(b));return void f.add(b.parent)}f.add(b)}function c(){h.render(f,g)}function d(){f=new THREE.Scene,h=new THREE.WebGLRenderer,h.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(h.domElement),e()}function e(){requestAnimationFrame(e);for(var a in j)j[a].update();i.update(),c()}var f,g,h,i,j=[],k={createCamera:a,createMesh:b,init:d};return k}),define("solar-service",function(){"use strict";function a(a){c("../src/data/camera.properties.json",a)}function b(a){c("../src/data/system.properties.json",a)}function c(a,b){$.ajax(a,{success:function(a){return b(a)},error:function(a){console.error("Load JSON error:"+a)}})}var d={getCamera:a,getObjects:b};return d}),require(["scene-factory","solar-service"],function(a,b){function c(c){a.createCamera(c),a.init(),b.getObjects(d)}function d(b){b.forEach(function(b){a.createMesh(b)})}b.getCamera(c)});